<img class="@Class" src="@ResolvedUri" style="@Style"/>
@code {
    private string _mxcUri;
    private string _style;
    private string _resolvedUri;

    [Parameter]
    public string MxcUri {
        get => _mxcUri ?? "";
        set {
            Console.WriteLine($"New MXC uri: {value}");
            _mxcUri = value;
            UriHasChanged(value);
        }
    }
    
    //mxcuri binding
    
    
    [Parameter]
    public string Style {
        get => _style;
        set {
            _style = value;
            StateHasChanged();
        }
    }
    [Parameter]
    public RemoteHomeserver? Homeserver { get; set; }

    private string ResolvedUri {
        get => _resolvedUri;
        set {
            _resolvedUri = value;
            StateHasChanged();
        }
    }

    private async Task UriHasChanged(string value) {
        var uri = value[5..].Split('/');
        Console.WriteLine($"UriHasChanged: {value} {uri[0]}");
        if (Homeserver is null) {
            Console.WriteLine($"Homeserver is null, creating new remotehomeserver for {uri[0]}");
            Homeserver = await hsProvider.GetRemoteHomeserver(uri[0]);
        }
        ResolvedUri = Homeserver.ResolveMediaUri(value);
        Console.WriteLine($"ResolvedUri: {ResolvedUri}");
    }

    [Parameter]
    public string Class { get; set; }

}