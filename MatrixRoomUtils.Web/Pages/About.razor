@page "/About"
@using System.Net
@inject NavigationManager NavigationManager
@inject ILocalStorageService LocalStorage

<PageTitle>About</PageTitle>

<h3>Rory&::MatrixUtils - About</h3>
<hr/>
<p>Rory&::MatrixUtils is a "small" collection of tools to do not-so-everyday things.</p>
<p>These range from joining rooms on dead homeservers, to managing your accounts and rooms, and creating rooms based on templates.</p>

<br/><br/>
<p>You can find the source code on <a href="https://cgit.rory.gay/matrix/MatrixRoomUtils.git/">cgit.rory.gay</a>.<br/></p>
<p>You can also join the <a href="https://matrix.to/#/%23mru%3Arory.gay?via=rory.gay&via=matrix.org&via=feline.support">Matrix room</a> for this project.</p>
@if (BinDownloadAvailable) {
    <p>This deployment also serves a copy of the compiled, hosting-ready binaries at <a href="/MRU-BIN.tar.xz">/MRU-BIN.tar.xz</a>!</p>
}
@if (SrcDownloadAvailable) {
    <p>This deployment also serves a copy of the source code at <a href="/MRU-SRC.tar.xz">/MRU-SRC.tar.xz</a>!</p>
}

@code {
    private bool BinDownloadAvailable { get; set; }
    private bool SrcDownloadAvailable { get; set; }

    protected override async Task OnInitializedAsync() {
        using var hc = new HttpClient();
        var hr = await hc.SendAsync(new HttpRequestMessage(HttpMethod.Head, NavigationManager.ToAbsoluteUri("/MRU-BIN.tar.xz").AbsoluteUri));
        BinDownloadAvailable = hr.StatusCode == HttpStatusCode.OK;
        hr = await hc.SendAsync(new HttpRequestMessage(HttpMethod.Head, NavigationManager.ToAbsoluteUri("/MRU-SRC.tar.xz").AbsoluteUri));
        SrcDownloadAvailable = hr.StatusCode == HttpStatusCode.OK;
        await base.OnInitializedAsync();
    }

}
